<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Student Portal</title>
</head>
<body>
  <h2>Welcome, <%= user.name %></h2>
  <p>Today: <%= today %></p>
  <button id="toggleBtn"><%= status === 'logged_in' ? 'Log Out' : 'Log In' %></button>
  <p id="statusText">Status: <strong><%= status %></strong></p>
  <p><a href="/logout">Logout</a></p>

  <script>
    const btn = document.getElementById('toggleBtn');
    const statusText = document.getElementById('statusText');
    btn.addEventListener('click', async () => {
      btn.disabled = true;
      const res = await fetch('/student/toggle', { method:'POST', headers:{'Content-Type':'application/json'} });
      const j = await res.json();
      if (j.ok) {
        btn.innerText = (j.status === 'logged_in') ? 'Log Out' : 'Log In';
        statusText.innerHTML = 'Status: <strong>' + j.status + '</strong>';
      } else {
        alert('Error toggling');
      }
      btn.disabled = false;
    });
  </script>
</body></html>
